// http://gitlab.tf56.lo/biuge/zen-cli.git
const fs = require('fs-extra');
const os = require('os');
const path = require('path');
const download = require('download-git-repo');

const {fsExistsSync} = require('../util/tool');
// 把目标项目下载到当前目录下的test下
// https://github.com:biuge/base-webpack-cli
// const downloadGitRepo = () => {
//     return new Promise((resolve, reject) => {
//         DownloadGitRepo('https://github.com:biuge/base-webpack-cli', './test',  {clone: true}, err => {
//             if ( err ) {
//                 reject( err );
//                 return;
//             }
//             resolve( true );
//         } );
//     }).catch(error => console.log(error));
// };


// module.exports = {
//     downloadGitRepo:downloadGitRepo,
// };




module.exports = async function fetchRemotePreset(url, name, clone) {
    console.log(url,name);
    const tmpdir = path.join(process.cwd(), name);
    if (await fsExistsSync(tmpdir)) {
        await fs.remove(tmpdir);
    } else {
        await fs.mkdir(tmpdir);
    }
    // if (clone && fs.accessSync(tmpdir)) {
    //     await fs.remove(tmpdir);
    // }
    return new Promise((resolve, reject) => {
        download(url, tmpdir, { clone }, err => {
            if (err) return reject(err);
            resolve( true );
        });
    }).catch(error => console.log(error));
};